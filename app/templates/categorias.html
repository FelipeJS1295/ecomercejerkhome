{% extends "base.html" %}

{% block title %}Categorías - JerkHome{% endblock %}

{% block description %}Explora toda nuestra gama de muebles tapizados organizados por categorías. Sofás, seccionales, poltronas, camas, respaldos y living en JerkHome.{% endblock %}

{% block content %}
<!-- Full Screen Carousel -->
<section class="relative h-screen overflow-hidden bg-black">
    
    {% if categorias %}
    <!-- Carousel Container -->
    <div class="relative h-full">
        
        <!-- Slides -->
        <div id="carousel" class="relative h-full">
            {% for categoria in categorias %}
            <div class="carousel-slide absolute inset-0 transition-all duration-1000 ease-in-out {% if loop.index0 == 0 %}opacity-100 scale-100{% else %}opacity-0 scale-110{% endif %}" data-slide="{{ loop.index0 }}">
                
                <!-- Background Image with Parallax -->
                <div class="absolute inset-0 overflow-hidden">
                    {% if categoria.imagen %}
                    <img src="{{ url_for('static', path='/images/categorias/' + categoria.imagen) }}" 
                         alt="{{ categoria.nombre }}" 
                         class="w-full h-full object-cover scale-110 transition-transform duration-[3000ms] ease-out"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    {% endif %}
                    
                    <!-- Fallback Background -->
                    <div class="w-full h-full bg-gradient-to-br from-gray-900 via-orange-900/30 to-red-900/50 flex items-center justify-center {% if categoria.imagen %}hidden{% endif %}" {% if categoria.imagen %}style="display:none;"{% endif %}>
                        <div class="text-center">
                            {% if categoria.nombre.lower() == 'sofas' %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20,9V7A2,2 0 0,0 18,5H16A2,2 0 0,0 14,7V9A3,3 0 0,0 11,12V16A1,1 0 0,0 12,17H12.8L13,19H15L14.8,17H17.2L17,19H19L18.2,17H19A1,1 0 0,0 20,16V12A3,3 0 0,0 20,9M16,7H18V9H16V7Z"/>
                            </svg>
                            {% elif categoria.nombre.lower() == 'seccionales' %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3,11V16A1,1 0 0,0 4,17H5L5.2,19H7.2L7,17H17L17.2,19H19.2L19,17H20A1,1 0 0,0 21,16V11A3,3 0 0,0 18,8V6A2,2 0 0,0 16,4H14A2,2 0 0,0 12,6V8H8V6A2,2 0 0,0 6,4H4A2,2 0 0,0 2,6V8A3,3 0 0,0 3,11M4,6H6V8H4V6M14,6H16V8H14V6Z"/>
                            </svg>
                            {% elif categoria.nombre.lower() == 'poltronas' %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M7,14V11A4,4 0 0,1 11,7H13A4,4 0 0,1 17,11V14H19A1,1 0 0,1 20,15V16A1,1 0 0,1 19,17H18.8L19,19H17L18.8,17H5.2L5,19H3L3.2,17H5A1,1 0 0,1 4,16V15A1,1 0 0,1 5,14H7Z"/>
                            </svg>
                            {% elif categoria.nombre.lower() == 'camas' %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19,7H5A3,3 0 0,0 2,10V17H4V15H20V17H22V10A3,3 0 0,0 19,7M4,10A1,1 0 0,1 5,9H19A1,1 0 0,1 20,10V13H4V10Z"/>
                            </svg>
                            {% elif categoria.nombre.lower() == 'respaldos' %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12,2A2,2 0 0,1 14,4V8A2,2 0 0,1 12,10A2,2 0 0,1 10,8V4A2,2 0 0,1 12,2M19,7H16V9H19A1,1 0 0,1 20,10V15H22V10A3,3 0 0,0 19,7M5,7A3,3 0 0,0 2,10V15H4V10A1,1 0 0,1 5,9H8V7H5Z"/>
                            </svg>
                            {% elif categoria.nombre.lower() == 'living' %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8,5V7H16V5H21V19H3V5H8M6,9V17H18V9H6M8,11H10V15H8V11M14,11H16V15H14V11Z"/>
                            </svg>
                            {% else %}
                            <svg class="w-48 h-48 text-orange-500/30 mx-auto mb-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2L2 7v10c0 5.55 3.84 10 9 10s9-4.45 9-10V7l-10-5z"/>
                            </svg>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- Dark Overlay with Gradient -->
                <div class="absolute inset-0 bg-gradient-to-r from-black/80 via-black/50 to-transparent"></div>
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-black/40"></div>
                
                <!-- Content -->
                <div class="relative h-full flex items-center">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full">
                        <div class="max-w-3xl">
                            
                            <!-- Decorative Line -->
                            <div class="flex items-center mb-6">
                                <div class="w-20 h-px bg-gradient-to-r from-orange-500 to-transparent"></div>
                            </div>
                            
                            <!-- Main Title -->
                            <h1 class="text-6xl md:text-8xl lg:text-9xl font-black text-white mb-6 leading-none tracking-tight">
                                {{ categoria.nombre|upper }}
                            </h1>
                            
                            <!-- Subtitle -->
                            <div class="mb-8">
                                <h2 class="text-xl md:text-2xl text-orange-400 font-medium mb-4 tracking-wide">
                                    COLECCIÓN JERKHOME
                                </h2>
                                <p class="text-lg md:text-xl text-gray-300 leading-relaxed max-w-2xl">
                                    {{ categoria.descripcion }}
                                </p>
                            </div>
                            
                            <!-- Stats and CTA -->
                            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-6">
                                
                                <!-- Product Count -->
                                <div class="flex items-center bg-black/50 backdrop-blur-sm border border-orange-500/30 rounded-full px-6 py-3">
                                    <span class="text-orange-500 font-bold text-lg mr-3">{{ categoria.productos|length if categoria.productos else 0 }}</span>
                                    <span class="text-white text-sm">PRODUCTOS</span>
                                </div>
                                
                                <!-- CTA Button -->
                                <a href="/categoria/{{ categoria.nombre.lower() }}" 
                                   class="group inline-flex items-center bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white font-bold py-4 px-8 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl hover:shadow-orange-500/30">
                                    <span class="text-lg tracking-wide">EXPLORAR COLECCIÓN</span>
                                    <svg class="w-6 h-6 ml-4 group-hover:translate-x-2 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        

        
        <!-- Slide Indicators -->
        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 z-20">
            <div class="flex space-x-4">
                {% for categoria in categorias %}
                <button class="slide-indicator w-16 h-1 bg-white/30 hover:bg-orange-500 transition-all duration-300 {% if loop.index0 == 0 %}bg-orange-500{% endif %}" data-slide="{{ loop.index0 }}">
                    <span class="sr-only">Slide {{ loop.index }}</span>
                </button>
                {% endfor %}
            </div>
        </div>
        
        <!-- Current Slide Info -->
        <div class="absolute top-8 right-8 z-20">
            <div class="bg-black/50 backdrop-blur-sm border border-white/20 rounded-lg px-4 py-2">
                <span class="text-white text-sm">
                    <span id="currentSlide">01</span> / {{ "%02d"|format(categorias|length) }}
                </span>
            </div>
        </div>
        
        <!-- Side Navigation Preview -->
        <div class="absolute right-8 top-1/2 transform -translate-y-1/2 z-20 hidden lg:block">
            <div class="space-y-4">
                {% for categoria in categorias %}
                <button class="side-nav-item group block text-right" data-slide="{{ loop.index0 }}">
                    <div class="text-white/50 hover:text-orange-500 transition-colors duration-300 text-sm font-medium">
                        {{ categoria.nombre|upper }}
                    </div>
                    <div class="w-8 h-px bg-white/20 group-hover:bg-orange-500 group-hover:w-16 transition-all duration-300 ml-auto mt-1"></div>
                </button>
                {% endfor %}
            </div>
        </div>
    </div>
    
    {% else %}
    <!-- Empty State -->
    <div class="h-full flex items-center justify-center bg-gradient-to-br from-gray-900 to-black">
        <div class="text-center max-w-md">
            <div class="w-32 h-32 bg-gradient-to-br from-orange-500 to-red-600 rounded-full mx-auto mb-8 flex items-center justify-center">
                <svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                </svg>
            </div>
            
            <h2 class="text-4xl font-bold text-white mb-6">No hay categorías disponibles</h2>
            <p class="text-gray-400 text-lg mb-8">Pronto agregaremos nuevas categorías de productos a nuestra colección.</p>
            
            <a href="/productos" 
               class="inline-flex items-center bg-gradient-to-r from-orange-500 to-red-600 text-white font-bold py-4 px-8 hover:shadow-2xl hover:shadow-orange-500/30 transition-all duration-300">
                <span>Ver Todos los Productos</span>
                <svg class="w-6 h-6 ml-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                </svg>
            </a>
        </div>
    </div>
    {% endif %}
</section>

<!-- Carousel JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const slides = document.querySelectorAll('.carousel-slide');
    const indicators = document.querySelectorAll('.slide-indicator');
    const sideNavItems = document.querySelectorAll('.side-nav-item');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const currentSlideDisplay = document.getElementById('currentSlide');
    
    if (!slides.length) return;
    
    let currentSlide = 0;
    const totalSlides = slides.length;
    let isTransitioning = false;
    
    function updateSlide(newSlide) {
        if (isTransitioning || newSlide === currentSlide) return;
        
        isTransitioning = true;
        
        // Hide current slide
        slides[currentSlide].classList.remove('opacity-100', 'scale-100');
        slides[currentSlide].classList.add('opacity-0', 'scale-110');
        
        // Update current slide index
        currentSlide = newSlide;
        
        // Show new slide
        setTimeout(() => {
            slides[currentSlide].classList.remove('opacity-0', 'scale-110');
            slides[currentSlide].classList.add('opacity-100', 'scale-100');
            
            // Update background image animation
            const img = slides[currentSlide].querySelector('img');
            if (img) {
                img.classList.remove('scale-110');
                img.classList.add('scale-100');
                setTimeout(() => {
                    img.classList.remove('scale-100');
                    img.classList.add('scale-110');
                }, 100);
            }
            
            isTransitioning = false;
        }, 500);
        
        // Update indicators
        indicators.forEach((indicator, index) => {
            if (index === currentSlide) {
                indicator.classList.add('bg-orange-500');
                indicator.classList.remove('bg-white/30');
            } else {
                indicator.classList.remove('bg-orange-500');
                indicator.classList.add('bg-white/30');
            }
        });
        
        // Update side navigation
        sideNavItems.forEach((item, index) => {
            const text = item.querySelector('div');
            const line = item.querySelector('div:nth-child(2)');
            if (index === currentSlide) {
                text.classList.add('text-orange-500');
                text.classList.remove('text-white/50');
                line.classList.add('bg-orange-500', 'w-16');
                line.classList.remove('bg-white/20', 'w-8');
            } else {
                text.classList.remove('text-orange-500');
                text.classList.add('text-white/50');
                line.classList.remove('bg-orange-500', 'w-16');
                line.classList.add('bg-white/20', 'w-8');
            }
        });
        
        // Update slide counter
        if (currentSlideDisplay) {
            currentSlideDisplay.textContent = String(currentSlide + 1).padStart(2, '0');
        }
    }
    
    function nextSlide() {
        const next = (currentSlide + 1) % totalSlides;
        updateSlide(next);
    }
    
    function prevSlide() {
        const prev = (currentSlide - 1 + totalSlides) % totalSlides;
        updateSlide(prev);
    }
    
    // Event listeners
    // Removed navigation buttons
    
    // Indicator navigation
    indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', () => updateSlide(index));
    });
    
    // Side navigation
    sideNavItems.forEach((item, index) => {
        item.addEventListener('click', () => updateSlide(index));
    });
    
    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') nextSlide();
        if (e.key === 'ArrowLeft') prevSlide();
    });
    
    // Touch/swipe support
    let startX = 0;
    let currentX = 0;
    let isDragging = false;
    
    document.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
        isDragging = true;
    }, { passive: true });
    
    document.addEventListener('touchmove', (e) => {
        if (!isDragging) return;
        currentX = e.touches[0].clientX;
    }, { passive: true });
    
    document.addEventListener('touchend', () => {
        if (!isDragging) return;
        isDragging = false;
        
        const diffX = startX - currentX;
        if (Math.abs(diffX) > 50) {
            if (diffX > 0) {
                nextSlide();
            } else {
                prevSlide();
            }
        }
    });
    
    // Auto-play
    let autoPlay = setInterval(nextSlide, 5000);
    
    // Pause auto-play on hover
    document.addEventListener('mouseenter', () => clearInterval(autoPlay));
    document.addEventListener('mouseleave', () => {
        autoPlay = setInterval(nextSlide, 5000);
    });
    
    // Initialize first slide
    updateSlide(0);
});
</script>
{% endblock %}